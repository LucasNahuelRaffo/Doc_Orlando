{"version":3,"file":"static/js/970.79a3fa21.chunk.js","mappings":"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","sources":["components/ConsultationAI.jsx"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\n\r\n/**\r\n * Consulta IA con animaciones:\r\n * - Reveal on scroll (IntersectionObserver) para header, formulario y sidebar.\r\n * - Stagger en ítems del historial.\r\n * - Barra de progreso indeterminada mientras loading.\r\n */\r\n\r\nexport default function ConsultationAI() {\r\n  const [notes, setNotes] = useState(\"\");\r\n  const [history, setHistory] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [summary, setSummary] = useState(null);\r\n  const [error, setError] = useState(null);\r\n  const textareaRef = useRef(null);\r\n  const rootRef = useRef(null);\r\n\r\n  // Reveal on scroll\r\n  useEffect(() => {\r\n    const root = rootRef.current;\r\n    if (!root || !(\"IntersectionObserver\" in window)) return;\r\n    const els = Array.from(root.querySelectorAll(\".ai-anim\"));\r\n\r\n    const io = new IntersectionObserver(\r\n      (entries, obs) => {\r\n        entries.forEach((e) => {\r\n          if (e.isIntersecting) {\r\n            e.target.classList.add(\"is-inview\");\r\n            obs.unobserve(e.target);\r\n          }\r\n        });\r\n      },\r\n      { threshold: 0.18, rootMargin: \"0px 0px -10% 0px\" }\r\n    );\r\n\r\n    els.forEach((el) => io.observe(el));\r\n    return () => io.disconnect();\r\n  }, []);\r\n\r\n  function handleClear() {\r\n    setNotes(\"\");\r\n    setSummary(null);\r\n    setError(null);\r\n    if (textareaRef.current) textareaRef.current.focus();\r\n  }\r\n\r\n  async function handleGenerate(e) {\r\n    e.preventDefault();\r\n    setError(null);\r\n\r\n    const text = (notes || \"\").trim();\r\n    if (!text) {\r\n      setError(\"Por favor ingrese notas para generar un resumen.\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setSummary(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/ai/resume\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ notes: text }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errText = await res.text();\r\n        throw new Error(errText || \"Error en el servidor\");\r\n      }\r\n\r\n      const data = await res.json();\r\n      const aiSummary = data.summary || data.result || \"No se obtuvo respuesta.\";\r\n\r\n      const entry = {\r\n        id: Date.now(),\r\n        text,\r\n        summary: aiSummary,\r\n        createdAt: new Date().toLocaleString(),\r\n      };\r\n      setHistory((s) => [entry, ...s]);\r\n      setSummary(aiSummary);\r\n      setNotes(\"\");\r\n    } catch (err) {\r\n      console.error(err);\r\n      setError(\"No se pudo generar el resumen. Intenta más tarde.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <section\r\n      ref={rootRef}\r\n      className=\"section ai-consult\"\r\n      style={{ paddingTop: \"3.5rem\", paddingBottom: \"4rem\" }}\r\n    >\r\n      <div className=\"container\" style={{ maxWidth: 1100 }}>\r\n        {/* Header animado */}\r\n        <header className=\"ai-anim ai-up\" style={{ textAlign: \"center\", marginBottom: \"1.25rem\", \"--ai-delay\":\"60ms\" }}>\r\n          <h1 className=\"h2\" style={{ fontSize: \"clamp(2rem, 4.5vw, 3.25rem)\" }}>\r\n            Consulta Virtual con IA\r\n          </h1>\r\n          <p className=\"lead\" style={{ maxWidth: 820, margin: \"12px auto 0\" }}>\r\n            Describa sus inquietudes o pegue las notas de una consulta y nuestra IA generará un\r\n            resumen claro y sugerirá los próximos pasos a seguir. Esta herramienta es para fines\r\n            informativos y no reemplaza una consulta médica real.\r\n          </p>\r\n        </header>\r\n\r\n        <div\r\n          className=\"ai-grid\"\r\n          style={{\r\n            display: \"grid\",\r\n            gridTemplateColumns: \"1fr 360px\",\r\n            gap: \"1.5rem\",\r\n            marginTop: \"2.25rem\",\r\n          }}\r\n        >\r\n          {/* Formulario (izquierda) */}\r\n          <div\r\n            className={`surface rounded-xl shadow ai-form ai-anim ai-left ${loading ? \"is-loading\" : \"\"}`}\r\n            style={{ padding: \"1rem\", \"--ai-delay\":\"140ms\" }}\r\n          >\r\n            {/* Barra de progreso indeterminada (solo visible con .is-loading) */}\r\n            <div className=\"ai-progress\" aria-hidden />\r\n\r\n            <h3 className=\"h3\" style={{ margin: 0, marginBottom: \".5rem\" }}>Ingrese sus Notas</h3>\r\n\r\n            <form\r\n              onSubmit={handleGenerate}\r\n              style={{ display: \"flex\", flexDirection: \"column\", gap: \".75rem\", marginTop: \".75rem\" }}\r\n            >\r\n              <textarea\r\n                ref={textareaRef}\r\n                value={notes}\r\n                onChange={(e) => setNotes(e.target.value)}\r\n                placeholder=\"Describe aquí los síntomas, preguntas o información de la consulta...\"\r\n                className=\"ai-textarea\"\r\n                style={{\r\n                  minHeight: 200,\r\n                  resize: \"vertical\",\r\n                  width: \"100%\",\r\n                  padding: \"1rem\",\r\n                  borderRadius: 8,\r\n                  background: \"transparent\",\r\n                  border: \"1px solid rgba(255,255,255,0.04)\",\r\n                  color: \"inherit\",\r\n                }}\r\n              />\r\n\r\n              {error && (\r\n                <div className=\"ai-anim ai-up is-inview\" style={{ color: \"#ffb3b3\", fontWeight: 600, \"--ai-delay\":\"0ms\" }}>\r\n                  {error}\r\n                </div>\r\n              )}\r\n\r\n              {summary && (\r\n                <div className=\"ai-summary ai-anim ai-pop is-inview\" style={{ \"--ai-delay\":\"0ms\" }}>\r\n                  <strong>Resumen generado:</strong>\r\n                  <p style={{ margin: \".5rem 0 0\", color: \"var(--blanco-perla)\", opacity: .9 }}>{summary}</p>\r\n                </div>\r\n              )}\r\n\r\n              <div style={{ display: \"flex\", gap: \".75rem\", alignItems: \"center\" }}>\r\n                <div className=\"hbg\" style={{ display: \"inline-flex\" }}>\r\n                  <button\r\n                    type=\"submit\"\r\n                    className=\"hbg__btn btn btn--primary ai-btn\"\r\n                    style={{ minWidth: 220 }}\r\n                    disabled={loading}\r\n                  >\r\n                    {loading ? \"Generando…\" : \"✨ Generar Resumen\"}\r\n                  </button>\r\n                  <span className=\"hbg__halo\" aria-hidden=\"true\" />\r\n                </div>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"btn btn--ghost ai-btn-ghost\"\r\n                  onClick={handleClear}\r\n                  title=\"Limpiar\"\r\n                >\r\n                  Limpiar\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n\r\n          {/* Sidebar (derecha) */}\r\n          <aside className=\"surface rounded-xl shadow ai-anim ai-right\" style={{ padding: \"1rem\", \"--ai-delay\":\"200ms\" }}>\r\n            <h3 className=\"h3\" style={{ margin: 0, marginBottom: \".5rem\" }}>Historial de Consultas</h3>\r\n            <div style={{ marginTop: \".75rem\", minHeight: 80 }}>\r\n              {history.length === 0 ? (\r\n                <p className=\"muted\" style={{ margin: 0 }}>No hay consultas guardadas.</p>\r\n              ) : (\r\n                <ul\r\n                  style={{\r\n                    margin: 0,\r\n                    padding: 0,\r\n                    listStyle: \"none\",\r\n                    display: \"grid\",\r\n                    gap: \".6rem\",\r\n                  }}\r\n                >\r\n                  {history.map((h, i) => (\r\n                    <li\r\n                      key={h.id}\r\n                      className=\"ai-history-item ai-anim ai-up\"\r\n                      style={{\r\n                        borderRadius: 8,\r\n                        padding: \".6rem\",\r\n                        background: \"transparent\",\r\n                        border: \"1px solid rgba(255,255,255,0.03)\",\r\n                        \"--ai-delay\": `${i * 80}ms`,\r\n                      }}\r\n                    >\r\n                      <div style={{ fontWeight: 700 }}>{h.createdAt}</div>\r\n                      <div\r\n                        style={{\r\n                          fontSize: \".95rem\",\r\n                          color: \"var(--blanco-perla)\",\r\n                          opacity: .88,\r\n                          marginTop: \".25rem\",\r\n                        }}\r\n                      >\r\n                        {h.summary ? (\r\n                          <>\r\n                            <strong>Resumen:</strong>\r\n                            <div style={{ marginTop: 4 }}>{h.summary}</div>\r\n                          </>\r\n                        ) : (\r\n                          <div>\r\n                            {h.text.slice(0, 140)}\r\n                            {h.text.length > 140 ? \"…\" : \"\"}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              )}\r\n            </div>\r\n          </aside>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n}\r\n"],"names":["ConsultationAI","notes","setNotes","useState","history","setHistory","loading","setLoading","summary","setSummary","error","setError","textareaRef","useRef","rootRef","useEffect","root","current","window","els","Array","from","querySelectorAll","io","IntersectionObserver","entries","obs","forEach","e","isIntersecting","target","classList","add","unobserve","threshold","rootMargin","el","observe","disconnect","_jsx","ref","className","style","paddingTop","paddingBottom","children","_jsxs","maxWidth","textAlign","marginBottom","fontSize","margin","display","gridTemplateColumns","gap","marginTop","concat","padding","onSubmit","async","preventDefault","text","trim","res","fetch","method","headers","body","JSON","stringify","ok","errText","Error","data","json","aiSummary","result","entry","id","Date","now","createdAt","toLocaleString","s","err","console","flexDirection","value","onChange","placeholder","minHeight","resize","width","borderRadius","background","border","color","fontWeight","opacity","alignItems","type","minWidth","disabled","onClick","focus","title","length","listStyle","map","h","i","_Fragment","slice"],"sourceRoot":""}