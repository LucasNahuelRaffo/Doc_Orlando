"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[970],{9970:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var a=s(5043),n=s(285),i=s(579);const r="https://raffo123.app.n8n.cloud/webhook/chat/orlando";function c(){const e=(0,a.useRef)(null),t=(0,a.useRef)(null),[s,c]=(0,a.useState)([{id:"welcome",sender:"bot",text:"\xa1Hola! Soy el asistente del Dr. Orlando. \xbfEn qu\xe9 puedo ayudarte hoy?"}]),[o,l]=(0,a.useState)(""),[d,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const t=e.current;if(!t||!("IntersectionObserver"in window))return;const s=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("is-inview"),s.disconnect())})},{threshold:.1});return s.observe(t),()=>s.disconnect()},[]),(0,a.useEffect)(()=>{t.current&&t.current.scrollIntoView({behavior:"smooth",block:"end"})},[s]);const h=e=>{if("string"===typeof e)return e;if(!e)return null;const t=["reply","respuesta","text","message","output","response","content"];for(const s of t)if(e[s]){if("string"===typeof e[s])return e[s];if("object"===typeof e[s]){const t=h(e[s]);if(t)return t}}for(const s of Object.values(e)){if("string"===typeof s)return s;if("object"===typeof s&&null!==s){const e=h(s);if(e)return e}}return null};return(0,i.jsx)("section",{ref:e,id:"consulta-ia",className:"section ai-consult reveal-fade",style:{paddingTop:"8rem",paddingBottom:"4rem"},children:(0,i.jsxs)("div",{className:"container",style:{maxWidth:980},children:[(0,i.jsxs)("header",{style:{textAlign:"center",marginBottom:"2rem"},children:[(0,i.jsx)("h1",{className:"h2",style:{fontSize:"clamp(2rem, 4.5vw, 3.25rem)"},children:"Asistente Virtual"}),(0,i.jsx)("p",{className:"lead",style:{maxWidth:600,margin:"12px auto 0"},children:"Nuestro asistente inteligente est\xe1 listo para responder sus dudas sobre procedimientos y agendamiento."})]}),(0,i.jsx)("div",{className:"ai-chat-embed",children:(0,i.jsxs)("div",{className:"ai-chat-card",children:[(0,i.jsxs)("div",{className:"ai-chat-header",children:[(0,i.jsx)("div",{className:"ai-chat-avatar","aria-hidden":"true",children:(0,i.jsx)("img",{src:n,alt:""})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"ai-chat-title",children:"Orlando-Agent"}),(0,i.jsx)("div",{className:"ai-chat-subtitle",children:"Asistente de Est\xe9tica"})]})]}),(0,i.jsxs)("div",{className:"ai-chat-messages",children:[s.map(e=>(0,i.jsx)("div",{className:"ai-chat-message ".concat(e.sender),children:e.text},e.id)),(0,i.jsx)("div",{ref:t})]}),(0,i.jsxs)("form",{className:"ai-chat-input",onSubmit:e=>{e.preventDefault(),(async()=>{const e=o.trim();if(!e||d)return;const t="typing-".concat(Date.now());c(s=>[...s,{id:"user-".concat(Date.now()),sender:"user",text:e},{id:t,sender:"typing",text:"Orlando-Agent est\xe1 escribiendo..."}]),l(""),u(!0);try{const s=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});let a=await s.json();Array.isArray(a)&&(a=a[0]);let n=h(a);n||(n="El asistente no devolvi\xf3 una respuesta de texto. Revisa la configuraci\xf3n de n8n."),c(e=>[...e.filter(e=>e.id!==t),{id:"bot-".concat(Date.now()),sender:"bot",text:n}])}catch(s){console.error("Fetch Error:",s),c(e=>[...e.filter(e=>e.id!==t),{id:"bot-".concat(Date.now()),sender:"bot",text:"Lo siento, no pude conectar con el servidor de n8n."}])}finally{u(!1)}})()},children:[(0,i.jsx)("input",{type:"text",className:"ai-chat-input-field",value:o,onChange:e=>l(e.target.value),placeholder:"Escribe tu mensaje..."}),(0,i.jsx)("button",{type:"submit",className:"ai-chat-send",disabled:!o.trim()||d,children:"Enviar"})]})]})}),(0,i.jsxs)("div",{className:"ai-chat-mobile surface rounded-xl shadow",children:[(0,i.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,i.jsx)("div",{className:"ai-chat-avatar ai-chat-avatar--lg","aria-hidden":"true",children:(0,i.jsx)("img",{src:n,alt:""})}),(0,i.jsx)("h3",{className:"h3",children:"\xa1Hola! Soy tu asistente"}),(0,i.jsx)("p",{className:"muted",style:{marginTop:"0.5rem"},children:"Toca la burbuja de chat en la esquina inferior derecha para conversar conmigo."})]}),(0,i.jsx)("button",{onClick:()=>window.toggleN8nChat&&window.toggleN8nChat(!0),className:"btn btn--primary ai-btn",style:{borderRadius:"999px"},children:"Abrir chat ahora"})]})]})})}}}]);
//# sourceMappingURL=970.f42cb752.chunk.js.map